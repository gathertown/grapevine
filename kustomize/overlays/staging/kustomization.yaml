apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

metadata:
  name: grapevine-staging

resources:
  - ../../base

# Image transformations - updated dynamically by CI/CD
# Replace REGISTRY with your container registry (e.g., docker.io/myorg, ghcr.io/myorg, etc.)
images:
  - name: REGISTRY/grapevine-api
    newName: your-registry/grapevine-api
    newTag: staging
  - name: REGISTRY/grapevine
    newName: your-registry/grapevine
    newTag: staging
  - name: REGISTRY/grapevine-ingest-gatekeeper
    newName: your-registry/grapevine-ingest-gatekeeper
    newTag: staging
  - name: REGISTRY/grapevine-steward
    newName: your-registry/grapevine-steward
    newTag: staging
  - name: REGISTRY/grapevine-migrations
    newName: your-registry/grapevine-migrations
    newTag: staging
  - name: REGISTRY/grapevine-ingest-worker
    newName: your-registry/grapevine-ingest-worker
    newTag: staging
  - name: REGISTRY/grapevine-cron-worker
    newName: your-registry/grapevine-cron-worker
    newTag: staging
  - name: REGISTRY/grapevine-index-worker
    newName: your-registry/grapevine-index-worker
    newTag: staging
  - name: REGISTRY/grapevine-slackbot
    newName: your-registry/grapevine-slackbot
    newTag: staging
  - name: REGISTRY/grapevine-ambient-extraction
    newName: your-registry/grapevine-ambient-extraction
    newTag: staging

patches:
  - path: replicas-patch.yaml
  - path: resources-patch.yaml
  - path: ingress-patch.yaml
